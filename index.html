<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Factura Globo Arte</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: #fff6f6;
      display: flex;
      justify-content: center;
      padding: 20px;
      margin: 0;
    }

    @font-face {
        font-family: 'Athletic Outfit';
        src: url('./fonts/Athletic\ Outfit.ttf') format('truetype');
        font-weight: normal;
        font-style: normal;
        }

    .factura {
      width: 200mm;
      min-height: 200mm;
      margin: auto;
      background: #fff;
      border: 2px solid #ff4d4d;
      padding: 12mm 10mm 8mm 10mm; /* M치s espacio arriba, menos abajo */
      box-sizing: border-box;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(255, 0, 0, 0.15);
      color: #c00;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      border-bottom: 2px solid #ff4d4d;
      padding-bottom: 12px;
      margin-bottom: 12px;
    }

    .logo-section {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      width: 45%;
    }

    .logo {
    font-family: 'Athletic Outfit', cursive;
    font-size: 60px;
    color: #d40000;
    margin: 0;
    line-height: 1;
    font-style: italic;          /* 游눪 cursiva */
    letter-spacing: 1px;         /* 游눧 leve separaci칩n entre letras */
    font-weight: 450;            /* un poco m치s delgado visualmente */
    }


    .info-empresa {
      text-align: left;
      font-size: 14px;
      color: #b30000;
      margin-top: 8px;
      padding-left: 5px;
      margin-left: 20%;
    }

    .info-empresa p {
      margin: 3px 0;
    }

    .client-section {
      width: 50%;
      border: 2px solid #ff4d4d;
      border-radius: 8px;
      padding: 10px 12px;
      background: #fff9f9;
    }

    .client-section h2 {
      font-size: 16px;
      margin: 0 0 8px 0;
      color: #d40000;
      text-align: center;
    }

    .datos-cliente {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .datos-cliente label {
      font-size: 14px;
      color: #b30000;
      display: flex;
      justify-content: space-between;
    }

    .datos-cliente input {
      border: none;
      border-bottom: 1px solid #ff4d4d;
      outline: none;
      width: 65%;
      font-size: 13px;
      color: #333;
      background: transparent;
      transition: 0.2s;
    }

    .datos-cliente input:focus {
      border-bottom: 2px solid #ff0000;
    }

    .num-factura {
      text-align: center;
      font-weight: bold;
      font-size: 16px;
      margin: 8px 0;
      padding: 4px;
      border-top: 2px solid #ff4d4d;
      border-bottom: 2px solid #ff4d4d;
    }

    .tabla-factura {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      margin-top: 8px;
      border: 1px solid #ff4d4d;
    }

    .tabla-factura th {
      background: #ffeaea;
      border: 1px solid #ff4d4d;
      padding: 6px;
      text-align: center;
    }

    .tabla-factura td {
      border: 1px solid #ff4d4d;
      padding: 6px;
      text-align: left;
    }

    .acciones {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 12px 0;
    }

    #agregar {
      background: #ff4d4d;
      border: none;
      color: #fff;
      cursor: pointer;
      padding: 5px 12px;
      border-radius: 6px;
      font-size: 13px;
      transition: background 0.3s;
    }

    #agregar:hover {
      background: #e60000;
    }

    .total-box {
      display: flex;
      align-items: center;
      gap: 8px;
      background: #fff9f9;
      border: 2px solid #ff4d4d;
      border-radius: 8px;
      padding: 5px 8px;
      font-size: 14px;
      color: #d40000;
      font-weight: 600;
    }

    .total-box input {
      width: 120px;
      border: none;
      background: transparent;
      font-size: 14px;
      color: #333;
      text-align: right;
      outline: none;
      font-weight: bold;
    }

    .observaciones {
      margin-top: 15px;
      border: 1px solid #ff4d4d;
      border-radius: 8px;
      padding: 8px;
      background: #fff9f9;
    }

    .observaciones p {
      font-weight: bold;
      margin-bottom: 4px;
      color: #d40000;
      font-size: 14px;
    }

    .observaciones textarea {
      width: 100%;
      height: 60px;
      border: 1px solid #ff4d4d;
      border-radius: 8px;
      resize: none;
      padding: 5px;
      color: #333;
      font-size: 12px;
      background: #fff;
    }

    footer {
      clear: both;
      border-top: 2px solid #ff4d4d;
      margin-top: 25px; /* Reducido el margen superior */
      padding-top: 8px;
      font-size: 12px;
      text-align: center;
      color: #b30000;
    }

    .firma {
      display: flex;
      justify-content: space-between;
      margin-top: 6px;
    }

    .contacto {
      margin-top: 5px;
      font-size: 12px;
      font-weight: 600;
      color: #d40000;
    }

    #descargar {
      display: block;
      margin: 25px auto 0; /* Reducido el margen superior */
      background: linear-gradient(135deg, #ff4d4d, #ff1a1a);
      color: #fff;
      border: none;
      padding: 8px 20px;
      cursor: pointer;
      border-radius: 25px;
      font-size: 14px;
      transition: transform 0.2s, background 0.3s;
    }

    #descargar:hover {
      transform: scale(1.05);
      background: linear-gradient(135deg, #ff0000, #cc0000);
    }

    /* Estilos espec칤ficos para impresi칩n */
    @media print {
      body {
        padding: 0;
        margin: 0;
        background: white;
      }
      
      .factura {
        width: 100%;
        min-height: 100%;
        margin: 0;
        padding: 12mm 10mm 8mm 10mm;
        box-shadow: none;
        border-radius: 0;
      }
      
      #descargar, #agregar {
        display: none !important;
      }
      @media print {
  #tipoDocumentoSelect {
    display: none !important;
  }
}

    }
  </style>
</head>
<body>
  <div class="factura">
    <div class="header-container">
      <div class="logo-section">
        <h1 class="logo">Globo <span>Arte</span></h1>
        <div class="info-empresa">
          <p><strong>MARTHA PEREZ</strong></p>
          <p>NIT: 51.766.825 - 2</p>
          <p>REGIMEN SIMPLIFICADO</p>
        </div>
      </div>
      
      <div class="client-section">
        <h2>DATOS DEL CLIENTE</h2>
        <div class="datos-cliente">
          <label>CLIENTE: <input type="text" id="cliente"></label>
          <label>NIT: <input type="text" id="nit"></label>
          <label>FECHA: <input type="date" id="fecha"></label>
          <label>DIRECCI칍N: <input type="text" id="direccion"></label>
          <label>TEL칄FONO: <input type="text" id="telefono"></label>
        </div>
      </div>
    </div>

<div class="num-factura">
  <div style="display:flex; align-items:center; justify-content:center; gap:10px;">
    <select id="tipoDocumentoSelect" style="padding:4px 8px; border:1px solid #ff4d4d; border-radius:6px; color:#d40000; font-size:13px;">
      <option value="factura" selected>Factura</option>
      <option value="cotizacion">Cotizaci칩n</option>
    </select>
    <div id="tituloFactura">
      <span id="tipo-documento" contenteditable>FACTURA</span> VENTA N춿 <span contenteditable>197</span>
    </div>
  </div>
</div>


    <table class="tabla-factura">
      <thead>
        <tr>
          <th>CANT.</th>
          <th>DESCRIPCI칍N</th>
          <th>VALOR UNIDAD</th>
          <th>VALOR TOTAL</th>
        </tr>
      </thead>
      <tbody id="tabla-body">
        <tr>
          <td contenteditable></td>
          <td contenteditable></td>
          <td contenteditable></td>
          <td contenteditable></td>
        </tr>
      </tbody>
    </table>

    <div class="acciones">
      <button id="agregar">+ Agregar fila</button>
      <div class="total-box">
        <label for="total">TOTAL $</label>
        <input type="number" id="total" readonly>
      </div>
    </div>

    <div class="observaciones">
      <p>OBSERVACIONES:</p>
      <textarea id="observaciones">ESTA FACTURA SE ASIMILA EN TODOS SUS EFECTOS LEGALES A UNA LETRA DE CAMBIO SEG칔N ARTICULO 774 DECRETO 410 DE 1971 C칍DIGO DE COMERCIO</textarea>
    </div>

    <footer>
      <div class="firma">
        <p><strong>GLOBO ARTE</strong></p>
        <p>FIRMA Y SELLO DEL CLIENTE</p>
      </div>
      <p class="contacto">Calle 73A # 69M-21 Tel. 314 211 9946 martikaguila@hotmail.com</p>
    </footer>

    <button id="descargar">Descargar PDF</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script>
    document.getElementById('agregar').addEventListener('click', () => {
      const tabla = document.getElementById('tabla-body');
      const fila = document.createElement('tr');
      fila.innerHTML = `
        <td contenteditable></td>
        <td contenteditable></td>
        <td contenteditable></td>
        <td contenteditable></td>
      `;
      tabla.appendChild(fila);
    });

document.getElementById('descargar').addEventListener('click', () => {
  const factura = document.querySelector('.factura');
  
  // Selecciona los elementos a ocultar (botones + selector)
  const elementosOcultar = document.querySelectorAll('#descargar, #agregar, #tipoDocumentoSelect');
  // Guarda el display actual para restaurarlo luego
  const displayPrev = [];
  elementosOcultar.forEach((el, i) => {
    displayPrev[i] = el.style.display || '';
    el.style.display = 'none';
  });

  const opt = {
    margin: [5, 0, 5, 0], // 5mm arriba y abajo, 0 a los lados
    filename: 'Factura_GloboArte.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { 
      scale: 2, 
      useCORS: true,
      scrollY: 0,
      windowHeight: document.querySelector('.factura').scrollHeight
    },
    jsPDF: { 
      unit: 'mm', 
      format: 'a4', 
      orientation: 'portrait' 
    }
  };
  
  html2pdf().set(opt).from(factura).save().then(() => {
    // Restaurar display de los elementos ocultos
    elementosOcultar.forEach((el, i) => {
      el.style.display = displayPrev[i];
    });
  }).catch(() => {
    // En caso de error tambi칠n los restauramos
    elementosOcultar.forEach((el, i) => {
      el.style.display = displayPrev[i];
    });
  });
});


    // Fecha actual
    const today = new Date();
    document.getElementById('fecha').value = today.toISOString().split('T')[0];

    // Calcular total autom치ticamente
    document.addEventListener('input', function(e) {
      if (e.target.closest('#tabla-body')) calcularTotales();
    });

    function calcularTotales() {
      let total = 0;
      const filas = document.querySelectorAll('#tabla-body tr');
      
      filas.forEach(fila => {
        const celdas = fila.querySelectorAll('td');
        if (celdas.length === 4) {
          const cantidad = parseFloat(celdas[0].textContent) || 0;
          const valorUnidad = parseFloat(celdas[2].textContent) || 0;
          const valorTotal = cantidad * valorUnidad;
          if (!isNaN(valorTotal)) {
            celdas[3].textContent = valorTotal.toFixed(2);
            total += valorTotal;
          }
        }
      });
      document.getElementById('total').value = total.toFixed(2);
    }

    // 游댃 Cambiar entre "Factura" y "Cotizaci칩n"
        const tipoDocumentoSelect = document.getElementById('tipoDocumentoSelect');
        const tituloFactura = document.getElementById('tituloFactura');

        tipoDocumentoSelect.addEventListener('change', () => {
        if (tipoDocumentoSelect.value === 'cotizacion') {
            tituloFactura.innerHTML = '<span id="tipo-documento">COTIZACI칍N</span>';
        } else {
            tituloFactura.innerHTML = '<span id="tipo-documento">FACTURA</span> VENTA N춿 <span contenteditable>197</span>';
        }
        });


  </script>
</body>
</html>